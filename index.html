<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Unit 8: FILMS - Final Word Bank Edition</title>
<style>
  :root {
    --primary: #FF0055; /* Neon Red */
    --secondary: #00E5FF; /* Neon Cyan */
    --bg: #121212;
    --card: #1F1F1F;
    --text: #ffffff;
    --correct: #00C853;
    --wrong: #D50000;
  }

  body { margin: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg); color: var(--text); padding-bottom: 70px; }
  
  /* HEADER */
  header {
    background: #252525; padding: 15px 20px; border-bottom: 1px solid #333;
    position: sticky; top: 0; z-index: 100; display: flex; justify-content: space-between; align-items: center;
  }
  .brand { font-size: 20px; font-weight: 900; color: var(--secondary); text-transform: uppercase; letter-spacing: 1px; }
  .stats { font-size: 14px; color: #aaa; font-weight: bold; }
  .score-box { background: var(--primary); padding: 5px 10px; border-radius: 15px; color: white; margin-left: 5px; }

  /* CONTAINER */
  .container { max-width: 900px; margin: 20px auto; padding: 0 15px; display: grid; grid-template-columns: 220px 1fr; gap: 20px; }
  @media (max-width: 768px) { .container { grid-template-columns: 1fr; } }

  /* SIDEBAR */
  .sidebar {
    background: var(--card); border-radius: 8px; padding: 10px; height: fit-content;
    position: sticky; top: 80px; border: 1px solid #333;
  }
  .nav-btn {
    display: block; width: 100%; text-align: left; padding: 12px; border: none; background: transparent;
    color: #bbb; cursor: pointer; border-radius: 6px; font-size: 14px; margin-bottom: 2px; border-bottom: 1px solid #333;
  }
  .nav-btn:hover { background: #333; color: #fff; }
  .nav-btn.active { background: var(--primary); color: #fff; font-weight: 700; box-shadow: 0 0 10px rgba(255, 0, 85, 0.4); }

  /* MAIN CONTENT */
  .slide { 
    background: var(--card); padding: 25px; border-radius: 12px; border: 1px solid #333;
    min-height: 400px; /* Ensure visibility */
  }

  h2 { margin: 0 0 15px 0; color: var(--secondary); font-size: 22px; border-bottom: 1px solid #444; padding-bottom: 10px;}
  .desc { color: #888; font-style: italic; font-size: 14px; margin-bottom: 20px; }

  /* READING & DIALOGUE SCROLL */
  .scroll-content {
    background: #2A2A2A; padding: 15px; border-radius: 8px; max-height: 400px; overflow-y: auto;
    font-size: 16px; line-height: 1.6; border: 1px solid #444; margin-bottom: 20px;
  }
  .line { padding: 8px; border-radius: 4px; margin-bottom: 5px; cursor: pointer; border-left: 3px solid transparent; }
  .line:hover { background: #333; }
  .line.active { background: #3E3E3E; border-left-color: var(--primary); color: var(--secondary); }
  .en { display: block; color: #eee; }
  .vi { display: block; font-size: 14px; color: #999; margin-top: 3px; font-style: italic; }
  .hidden { display: none; }

  /* QUIZ STYLES */
  .q-block { margin-bottom: 30px; border-bottom: 1px dashed #444; padding-bottom: 20px; }
  .q-text { font-size: 18px; font-weight: 600; margin-bottom: 10px; color: #fff; }
  .q-vi { font-size: 15px; color: #aaa; margin-bottom: 15px; font-style: italic; }

  /* OPTIONS GRID (WORD BANK) */
  .opts-grid { display: flex; flex-wrap: wrap; gap: 10px; }
  .opt-btn {
    padding: 10px 20px; background: #333; border: 2px solid #555; border-radius: 20px; color: #eee;
    cursor: pointer; transition: 0.2s; font-size: 15px; font-weight: 500;
    flex: 1 1 45%; /* 2 columns */
    display: flex; flex-direction: column; align-items: center; justify-content: center;
  }
  .opt-btn:hover { background: #444; border-color: #888; }
  .opt-sub { font-size: 12px; color: #888; margin-top: 2px; }

  /* FEEDBACK */
  .opt-btn.correct { background: #1b5e20; border-color: var(--correct); color: #fff; pointer-events: none; }
  .opt-btn.wrong { background: #b71c1c; border-color: var(--wrong); opacity: 0.6; pointer-events: none; }
  
  .expl-box {
    margin-top: 15px; padding: 15px; background: #263238; border-left: 4px solid var(--secondary);
    border-radius: 4px; font-size: 14px; color: #cfd8dc; display: none;
  }

  /* FOOTER */
  .footer {
    position: fixed; bottom: 0; left: 0; width: 100%; background: #1a1a1a;
    padding: 12px; display: flex; justify-content: center; gap: 15px; border-top: 1px solid #333; z-index: 200;
  }
  .ctrl-btn {
    background: #333; color: #fff; border: 1px solid #555; padding: 8px 20px; border-radius: 20px;
    cursor: pointer; font-weight: bold; font-size: 13px;
  }
  .ctrl-btn.active { background: var(--secondary); color: #000; border-color: var(--secondary); }
  .ctrl-btn.music-on { background: #d500f9; border-color: #d500f9; animation: glow 1.5s infinite; }
  @keyframes glow { 0%{box-shadow:0 0 5px #d500f9;} 50%{box-shadow:0 0 15px #d500f9;} 100%{box-shadow:0 0 5px #d500f9;} }

  .next-btn {
    background: var(--primary); color: white; padding: 12px; width: 100%; border: none;
    border-radius: 8px; font-weight: bold; cursor: pointer; margin-top: 15px; display: none; font-size: 16px;
  }
  .next-btn:hover { background: #ff4081; }

</style>
</head>
<body>

<header>
  <div class="brand">UNIT 8: FILMS</div>
  <div class="stats">
    Ti·∫øn ƒë·ªô: <span id="qCount">0</span>/<span id="totalQ">0</span> 
    <span class="score-box">ƒêi·ªÉm: <span id="score">0</span></span>
  </div>
</header>

<div class="container">
  <aside class="sidebar" id="sidebar">
    </aside>

  <main id="main">
    </main>
</div>

<div class="footer">
  <button class="ctrl-btn" id="btnMusic" onclick="toggleMusic()">üéµ Nh·∫°c: OFF</button>
  <button class="ctrl-btn active" id="btnVi" onclick="toggleVi()">üáªüá≥ D·ªãch: ON</button>
  <button class="ctrl-btn" onclick="if(confirm('L√†m l·∫°i t·ª´ ƒë·∫ßu?')) location.reload()">‚Üª Reset</button>
</div>

<script>
/* ==========================================================================
   DATABASE (COMPLETE UNIT 8)
   Includes "opts" for ALL fill-in questions (Word Bank feature)
   ========================================================================== */
const DATA = [
  // --- SECTION 1: GETTING STARTED ---
  {
    id: "gs_read", title: "1. Getting Started", desc: "Listen & Read", type: "dialogue",
    script: [
      {r:"Mark", e:"Let's go to the cinema tonight!", v:"T·ªëi nay ƒëi xem phim ƒëi!"},
      {r:"Mi", e:"Good idea! What shall we see?", v:"√ù ki·∫øn hay! Xem phim g√¨ ƒë√¢y?"},
      {r:"Mark", e:"A Nightmare is on at Sao Mai Cinema tonight.", v:"Phim 'A Nightmare' ƒëang chi·∫øu ·ªü r·∫°p Sao Mai t·ªëi nay."},
      {r:"Mi", e:"Is it a fantasy?", v:"ƒê√≥ c√≥ ph·∫£i phim gi·∫£ t∆∞·ªüng kh√¥ng?"},
      {r:"Mark", e:"No, it's a horror film.", v:"Kh√¥ng, ƒë√≥ l√† phim kinh d·ªã."},
      {r:"Mi", e:"That's too scary for me. Look! An Old Pier is on at Town Cinema. It's a documentary.", v:"S·ª£ qu√° t·ªõ kh√¥ng xem ƒë√¢u. Nh√¨n k√¨a! 'An Old Pier' ƒëang chi·∫øu ·ªü r·∫°p Town. ƒê√≥ l√† phim t√†i li·ªáu."},
      {r:"Mark", e:"I don't really like documentaries. They're often boring. What about Our Holiday?", v:"T·ªõ kh√¥ng th√≠ch phim t√†i li·ªáu l·∫Øm. Ch√∫ng th∆∞·ªùng t·∫ª nh·∫°t. C√≤n phim 'Our Holiday' th√¨ sao?"},
      {r:"Mi", e:"What kind of film is it?", v:"ƒê√≥ l√† th·ªÉ lo·∫°i phim g√¨?"},
      {r:"Mark", e:"It's a comedy.", v:"ƒê√≥ l√† phim h√†i."},
      {r:"Mi", e:"And who stars in it?", v:"Ai ƒë√≥ng vai ch√≠nh?"},
      {r:"Mark", e:"Kate Harrison and Lily Collins.", v:"Kate Harrison v√† Lily Collins."},
      {r:"Mark", e:"It's about two women living in different countries and they decide to exchange houses.", v:"Phim k·ªÉ v·ªÅ hai ng∆∞·ªùi ph·ª• n·ªØ s·ªëng ·ªü hai n∆∞·ªõc kh√°c nhau v√† h·ªç quy·∫øt ƒë·ªãnh ƒë·ªïi nh√† cho nhau."},
      {r:"Mark", e:"Although a few people say it's a bit silly, most say it's funny and interesting.", v:"M·∫∑c d√π v√†i ng∆∞·ªùi n√≥i h∆°i ng·ªõ ng·∫©n, nh∆∞ng ƒëa s·ªë khen h√†i h∆∞·ªõc v√† th√∫ v·ªã."}
    ]
  },
  {
    id: "gs_ex2", title: "Getting Started - Ex 2", desc: "Read again & Answer", type: "quiz",
    qs: [
      {q:"What does Mark suggest doing tonight?", v:"Mark g·ª£i √Ω l√†m g√¨?", o:[{t:"Watching a TV show",v:""},{t:"Watching a film",v:"ƒêi xem phim"},{t:"Staying at home",v:""}], a:1, e:"Mark n√≥i: 'Let's go to the cinema tonight!'"},
      {q:"Why doesn't Mark want to see 'An Old Pier'?", v:"T·∫°i sao Mark kh√¥ng mu·ªën xem?", o:[{t:"He dislikes that type",v:"Kh√¥ng th√≠ch th·ªÉ lo·∫°i ƒë√≥"},{t:"Inconvenient time",v:""},{t:"Seen it last week",v:""}], a:0, e:"Mark: 'I don't really like documentaries.'"},
      {q:"The word 'reviews' mostly means ______.", v:"T·ª´ 'reviews' nghƒ©a l√†...", o:[{t:"opinions about a film",v:"√Ω ki·∫øn v·ªÅ phim"},{t:"interesting scenes",v:""},{t:"what people dislike",v:""}], a:0, e:"Reviews = Opinions (√ù ki·∫øn ƒë√°nh gi√°)."},
      {q:"What do people think of 'Our Holiday'?", v:"M·ªçi ng∆∞·ªùi nghƒ© g√¨ v·ªÅ phim?", o:[{t:"Everyone likes it",v:""},{t:"No one likes it",v:""},{t:"Most people like it",v:"ƒêa s·ªë th√≠ch"}], a:2, e:"Mark: 'most say it's funny'."}
    ]
  },
  {
    id: "gs_ex3", title: "Getting Started - Ex 3", desc: "Types of Film", type: "quiz",
    qs: [
      {q:"A film that tries to make the audience laugh.", v:"Phim g√¢y c∆∞·ªùi.", o:[{t:"Comedy",v:"H√†i"},{t:"Documentary",v:""},{t:"Action",v:""}], a:0, e:"Comedy = Phim h√†i."},
      {q:"A film based only on imagination, not real facts.", v:"Phim d·ª±a tr√™n t∆∞·ªüng t∆∞·ª£ng.", o:[{t:"Comedy",v:""},{t:"Fantasy",v:"Gi·∫£ t∆∞·ªüng"},{t:"Drama",v:""}], a:1, e:"Fantasy = Phim gi·∫£ t∆∞·ªüng."},
      {q:"A film showing real life events/stories.", v:"Phim chi·∫øu s·ª± ki·ªán th·∫≠t.", o:[{t:"Documentary",v:"T√†i li·ªáu"},{t:"Horror",v:""},{t:"Sci-fi",v:""}], a:0, e:"Documentary = Phim t√†i li·ªáu."},
      {q:"A film set in the future, often about science.", v:"Phim b·ªëi c·∫£nh t∆∞∆°ng lai/khoa h·ªçc.", o:[{t:"Cartoon",v:""},{t:"Sci-fi",v:"Vi·ªÖn t∆∞·ªüng"},{t:"History",v:""}], a:1, e:"Sci-fi = Khoa h·ªçc vi·ªÖn t∆∞·ªüng."},
      {q:"A film where strange and frightening things happen.", v:"Phim c√≥ ƒëi·ªÅu ƒë√°ng s·ª£.", o:[{t:"Horror",v:"Kinh d·ªã"},{t:"Comedy",v:""},{t:"Action",v:""}], a:0, e:"Horror = Phim kinh d·ªã."}
    ]
  },
  {
    id: "gs_ex4", title: "Getting Started - Ex 4", desc: "Adjectives (Word Bank)", type: "quiz",
    qs: [
      {q:"The film was so ______ that we fell asleep.", v:"Phim... n√™n ng·ªß g·∫≠t.", o:[{t:"boring",v:"t·∫ª nh·∫°t"},{t:"funny",v:"h√†i"},{t:"moving",v:"c·∫£m ƒë·ªông"},{t:"frightening",v:"s·ª£"}], a:0, e:"Ng·ªß g·∫≠t (fell asleep) -> boring (ch√°n)."},
      {q:"Going to the hospital can be ______ for a child.", v:"ƒêi b·ªánh vi·ªán th√¨...", o:[{t:"frightening",v:"ƒë√°ng s·ª£"},{t:"interesting",v:"th√∫ v·ªã"},{t:"funny",v:""},{t:"boring",v:""}], a:0, e:"Tr·∫ª em th∆∞·ªùng s·ª£ (frightening) b·ªánh vi·ªán."},
      {q:"The film was so ______ that the audience couldn't stop laughing.", v:"C∆∞·ªùi kh√¥ng ng·ªõt.", o:[{t:"boring",v:""},{t:"moving",v:""},{t:"funny",v:"bu·ªìn c∆∞·ªùi"},{t:"shocking",v:""}], a:2, e:"C∆∞·ªùi (laughing) -> funny."},
      {q:"Many people cried when they saw the ______ scenes.", v:"Nhi·ªÅu ng∆∞·ªùi kh√≥c.", o:[{t:"moving",v:"c·∫£m ƒë·ªông"},{t:"violent",v:"b·∫°o l·ª±c"},{t:"funny",v:""},{t:"dull",v:"ch√°n"}], a:0, e:"Kh√≥c (cried) -> moving."},
      {q:"This book is ______. I got a lot of useful info.", v:"C√≥ nhi·ªÅu th√¥ng tin h·ªØu √≠ch.", o:[{t:"boring",v:""},{t:"interesting",v:"th√∫ v·ªã"},{t:"frightening",v:""},{t:"violent",v:""}], a:1, e:"Th√¥ng tin h·ªØu √≠ch -> interesting."}
    ]
  },

  // --- A CLOSER LOOK 1 ---
  {
    id: "cl1_ex1", title: "2. A Closer Look 1 - Ex 1", desc: "Match Definitions", type: "quiz",
    qs: [
      {q:"What does 'Violent' mean?", v:"Violent nghƒ©a l√† g√¨?", o:[{t:"Difficult to understand",v:""},{t:"Giving pleasure",v:""},{t:"Containing fighting",v:"B·∫°o l·ª±c"}], a:2, e:"Violent = B·∫°o l·ª±c."},
      {q:"What does 'Dull' mean?", v:"Dull nghƒ©a l√† g√¨?", o:[{t:"Boring",v:"T·∫ª nh·∫°t"},{t:"Very surprising",v:""},{t:"Frightening",v:""}], a:0, e:"Dull = Boring (T·∫ª nh·∫°t)."},
      {q:"What does 'Confusing' mean?", v:"Confusing nghƒ©a l√† g√¨?", o:[{t:"Difficult to understand",v:"Kh√≥ hi·ªÉu"},{t:"Giving pleasure",v:""},{t:"Very surprising",v:""}], a:0, e:"Confusing = G√¢y b·ªëi r·ªëi/Kh√≥ hi·ªÉu."},
      {q:"What does 'Shocking' mean?", v:"Shocking nghƒ©a l√† g√¨?", o:[{t:"Very surprising",v:"G√¢y s·ªëc"},{t:"Boring",v:""},{t:"Funny",v:""}], a:0, e:"Shocking = G√¢y s·ªëc/Kinh ng·∫°c."},
      {q:"What does 'Enjoyable' mean?", v:"Enjoyable nghƒ©a l√† g√¨?", o:[{t:"Giving pleasure",v:"Th√∫ v·ªã"},{t:"Boring",v:""},{t:"Violent",v:""}], a:0, e:"Enjoyable = Th√≠ch th√∫."}
    ]
  },
  {
    id: "cl1_ex2", title: "A Closer Look 1 - Ex 2", desc: "Word Bank: Fill in", type: "quiz",
    qs: [
      {q:"The film 'A Polluted Planet' is hard to believe. It's a ______ documentary.", v:"Kh√≥ tin -> ...", o:[{t:"dull",v:""},{t:"shocking",v:"g√¢y s·ªëc"},{t:"enjoyable",v:""},{t:"confusing",v:""}], a:1, e:"Hard to believe -> Shocking."},
      {q:"There were too many fights in the film. It was too ______.", v:"Qu√° nhi·ªÅu ƒë√°nh nhau.", o:[{t:"violent",v:"b·∫°o l·ª±c"},{t:"moving",v:""},{t:"funny",v:""},{t:"dull",v:""}], a:0, e:"Fights -> Violent."},
      {q:"You will enjoy 'Our Holiday'. It's quite ______.", v:"B·∫°n s·∫Ω th√≠ch n√≥.", o:[{t:"boring",v:""},{t:"violent",v:""},{t:"enjoyable",v:"th√∫ v·ªã"},{t:"shocking",v:""}], a:2, e:"Enjoy -> Enjoyable."},
      {q:"The film was so ______ that we almost fell asleep.", v:"Su√Ωt ng·ªß g·∫≠t.", o:[{t:"dull",v:"t·∫ª nh·∫°t"},{t:"shocking",v:""},{t:"enjoyable",v:""},{t:"violent",v:""}], a:0, e:"Sleep -> Dull/Boring."},
      {q:"I didn't understand the film. It was very ______.", v:"Kh√¥ng hi·ªÉu.", o:[{t:"moving",v:""},{t:"confusing",v:"kh√≥ hi·ªÉu"},{t:"funny",v:""},{t:"violent",v:""}], a:1, e:"Don't understand -> Confusing."}
    ]
  },

  // --- A CLOSER LOOK 2 ---
  {
    id: "cl2_ex2", title: "3. A Closer Look 2 - Ex 2", desc: "Connectors: Although / However", type: "quiz",
    qs: [
      {q:"______ the acting was good, I didn't like its story.", v:"______ di·ªÖn xu·∫•t t·ªët, t√¥i kh√¥ng th√≠ch c·ªët truy·ªán.", o:[{t:"Although",v:"M·∫∑c d√π"},{t:"However",v:""},{t:"Because",v:""}], a:0, e:"Hai m·ªánh ƒë·ªÅ trong 1 c√¢u -> Although."},
      {q:"I felt really tired. ______, I went to see the film.", v:"T√¥i m·ªát. ______, t√¥i v·∫´n ƒëi xem phim.", o:[{t:"Although",v:""},{t:"However",v:"Tuy nhi√™n"},{t:"So",v:""}], a:1, e:"ƒê·ª©ng sau d·∫•u ch·∫•m, tr∆∞·ªõc d·∫•u ph·∫©y -> However."},
      {q:"He studied hard. ______, he failed the exam.", v:"H·ªçc chƒÉm. ______, v·∫´n tr∆∞·ª£t.", o:[{t:"Although",v:""},{t:"However",v:"Tuy nhi√™n"},{t:"Because",v:""}], a:1, e:"Hai c√¢u ƒë·ªôc l·∫≠p -> However."},
      {q:"Mai speaks English well ______ her native language is Vietnamese.", v:"Mai n√≥i gi·ªèi ______ ti·∫øng m·∫π ƒë·∫ª l√† ti·∫øng Vi·ªát.", o:[{t:"although",v:""},{t:"however",v:""},{t:"but",v:""}], a:0, e:"M·ªánh ƒë·ªÅ nh∆∞·ª£ng b·ªô -> Although."},
      {q:"I really enjoyed the film ______ most of my friends didn't like it.", v:"T√¥i th√≠ch ______ b·∫°n t√¥i kh√¥ng th√≠ch.", o:[{t:"although",v:""},{t:"however",v:""},{t:"so",v:""}], a:0, e:"N·ªëi 2 m·ªánh ƒë·ªÅ -> Although."}
    ]
  },
  {
    id: "cl2_ex4", title: "A Closer Look 2 - Ex 4", desc: "Choose Correct Answer", type: "quiz",
    qs: [
      {q:"Mary overslept ______ she went to bed early.", v:"Ng·ªß qu√™n ______ ƒë√£ ƒëi ng·ªß s·ªõm.", o:[{t:"although",v:""},{t:"because",v:""},{t:"so",v:""}], a:0, e:"T∆∞∆°ng ph·∫£n (ng·ªß qu√™n >< ng·ªß s·ªõm) -> although."},
      {q:"______ the sun is shining, it isn't very warm.", v:"______ tr·ªùi n·∫Øng, kh√¥ng ·∫•m.", o:[{t:"Because",v:""},{t:"However",v:""},{t:"Though",v:"M·∫∑c d√π"}], a:2, e:"Though ƒë·ª©ng ƒë·∫ßu c√¢u ch·ªâ s·ª± nh∆∞·ª£ng b·ªô."},
      {q:"I don't like running. ______ I like swimming.", v:"Kh√¥ng th√≠ch ch·∫°y. ______ th√≠ch b∆°i.", o:[{t:"But",v:"Nh∆∞ng"},{t:"So",v:""},{t:"However",v:""}], a:0, e:"'But' n·ªëi 2 c√¢u ƒë∆°n gi·∫£n."},
      {q:"______ the film was exciting, Jim fell asleep.", v:"______ phim hay, Jim ng·ªß g·∫≠t.", o:[{t:"However",v:""},{t:"Although",v:""},{t:"Because",v:""}], a:1, e:"M·ªánh ƒë·ªÅ t∆∞∆°ng ph·∫£n -> Although."},
      {q:"The story is silly. ______, many people enjoyed it.", v:"Ng·ªõ ng·∫©n. ______, nhi·ªÅu ng∆∞·ªùi th√≠ch.", o:[{t:"However",v:""},{t:"Though",v:""},{t:"But",v:""}], a:0, e:"Sau d·∫•u ch·∫•m, c√≥ d·∫•u ph·∫©y -> However."}
    ]
  },

  // --- COMMUNICATION ---
  {
    id: "comm_ex3", title: "4. Communication - Ex 3", desc: "Film Survey Listen & Select", type: "quiz",
    qs: [
      {q:"What kind of films do you like (1) ______?", v:"B·∫°n th√≠ch phim g√¨ ______?", o:[{t:"best",v:"nh·∫•t"},{t:"good",v:""},{t:"better",v:""},{t:"most",v:""}], a:0, e:"Like best = Th√≠ch nh·∫•t."},
      {q:"I love (2) ______.", v:"T·ªõ y√™u ______.", o:[{t:"comedies",v:"phim h√†i"},{t:"action",v:""},{t:"horror",v:""},{t:"sci-fi",v:""}], a:0, e:"Theo h·ªôi tho·∫°i, Lan th√≠ch Comedies."},
      {q:"What's the name of your (3) ______ comedy?", v:"T√™n phim h√†i ______ c·ªßa b·∫°n?", o:[{t:"favourite",v:"y√™u th√≠ch"},{t:"best",v:""},{t:"funny",v:""},{t:"loving",v:""}], a:0, e:"Favourite comedy."},
      {q:"Who (4) ______ in it?", v:"Ai ______ trong ƒë√≥?", o:[{t:"stars",v:"ƒë√≥ng ch√≠nh"},{t:"plays",v:""},{t:"acts",v:""},{t:"does",v:""}], a:0, e:"Stars (ƒë·ªông t·ª´) = ƒë√≥ng vai ch√≠nh."},
      {q:"It's very (5) ______.", v:"N√≥ r·∫•t ______.", o:[{t:"funny",v:"h√†i h∆∞·ªõc"},{t:"sad",v:""},{t:"boring",v:""},{t:"bad",v:""}], a:0, e:"Lan nh·∫≠n x√©t: It's very funny."}
    ]
  },

  // --- SKILLS 1 ---
  {
    id: "skills1_read", title: "5. Skills 1 - Reading", desc: "Harry Potter Review", type: "reading",
    content: [
      {e:"Harry Potter and the Sorcerer's Stone is a fantasy. Its director is Chris Columbus.", v:"Harry Potter v√† H√≤n ƒë√° Ph√π th·ªßy l√† phim gi·∫£ t∆∞·ªüng. ƒê·∫°o di·ªÖn l√† Chris Columbus."},
      {e:"Daniel Radcliffe is one of the stars in the film. The film tells the story of Harry Potter, a powerful wizard.", v:"Daniel Radcliffe l√† ng√¥i sao. Phim k·ªÉ v·ªÅ Harry Potter, m·ªôt ph√π th·ªßy quy·ªÅn nƒÉng."},
      {e:"The film received a lot of good reviews. People say it's a must-see for teens.", v:"Phim nh·∫≠n nhi·ªÅu ƒë√°nh gi√° t·ªët. M·ªçi ng∆∞·ªùi n√≥i ƒë√¢y l√† phim ph·∫£i xem."},
      {e:"The story is gripping and the acting is excellent.", v:"C·ªët truy·ªán l√¥i cu·ªën v√† di·ªÖn xu·∫•t xu·∫•t s·∫Øc."},
      {e:"Although it is a little frightening at times, it is very interesting and full of action.", v:"M·∫∑c d√π ƒë√¥i khi h∆°i ƒë√°ng s·ª£, nh∆∞ng n√≥ r·∫•t th√∫ v·ªã v√† ƒë·∫ßy h√†nh ƒë·ªông."}
    ]
  },
  {
    id: "skills1_ex2", title: "Skills 1 - Ex 2", desc: "Match Words", type: "quiz",
    qs: [
      {q:"'Must-see' means ______.", v:"'Must-see' nghƒ©a l√†...", o:[{t:"highly recommended",v:"r·∫•t ƒë√°ng xem"},{t:"boring",v:""},{t:"long",v:""}], a:0, e:"Must-see = Ph·∫£i xem."},
      {q:"'Gripping' means ______.", v:"'Gripping' nghƒ©a l√†...", o:[{t:"very exciting",v:"l√¥i cu·ªën"},{t:"scary",v:""},{t:"funny",v:""}], a:0, e:"Gripping = H·∫•p d·∫´n/L√¥i cu·ªën."},
      {q:"'Wizard' means ______.", v:"'Wizard' nghƒ©a l√†...", o:[{t:"man with magic",v:"ph√π th·ªßy"},{t:"an actor",v:""},{t:"a director",v:""}], a:0, e:"Wizard = Ph√π th·ªßy."},
      {q:"'Series' means ______.", v:"'Series' nghƒ©a l√†...", o:[{t:"related films",v:"lo·∫°t phim"},{t:"one film",v:""},{t:"a book",v:""}], a:0, e:"Series = Lo·∫°t phim li√™n ti·∫øp."}
    ]
  },
  {
    id: "skills1_ex3", title: "Skills 1 - Ex 3", desc: "Reading Comprehension", type: "quiz",
    qs: [
      {q:"What kind of film is Harry Potter?", v:"Th·ªÉ lo·∫°i g√¨?", o:[{t:"Horror",v:""},{t:"Fantasy",v:"Gi·∫£ t∆∞·ªüng"},{t:"Documentary",v:""}], a:1, e:"B√†i ƒë·ªçc: 'is a fantasy'."},
      {q:"Who is Daniel Radcliffe?", v:"L√† ai?", o:[{t:"Director",v:""},{t:"One of the stars",v:"Di·ªÖn vi√™n ch√≠nh"},{t:"Wizard",v:""}], a:1, e:"B√†i ƒë·ªçc: 'one of the stars'."},
      {q:"What does Mark think about the story?", v:"Mark nghƒ© g√¨?", o:[{t:"Boring",v:""},{t:"Silly",v:""},{t:"Gripping",v:"L√¥i cu·ªën"}], a:2, e:"Mark: 'the story is gripping'."},
      {q:"Is the film frightening?", v:"C√≥ ƒë√°ng s·ª£ kh√¥ng?", o:[{t:"No, never",v:""},{t:"Yes, at times",v:"C√≥, ƒë√¥i khi"},{t:"Yes, always",v:""}], a:1, e:"B√†i ƒë·ªçc: 'frightening at times'."}
    ]
  },

  // --- SKILLS 2 ---
  {
    id: "skills2_listen", title: "6. Skills 2 - Listening", desc: "Film: Naughty Twins", type: "dialogue",
    script: [
      {r:"Mark", e:"Hoa, have you seen the film Naughty Twins?", v:"Hoa, xem phim C·∫∑p Sinh ƒê√¥i Ngh·ªãch Ng·ª£m ch∆∞a?"},
      {r:"Hoa", e:"Yes, I have. I saw it last week.", v:"R·ªìi, tu·∫ßn tr∆∞·ªõc."},
      {r:"Mark", e:"What kind of film is it?", v:"Th·ªÉ lo·∫°i g√¨?"},
      {r:"Hoa", e:"It's a comedy.", v:"Phim h√†i."},
      {r:"Mark", e:"Who are the main characters?", v:"Nh√¢n v·∫≠t ch√≠nh l√† ai?"},
      {r:"Hoa", e:"They are twin sisters.", v:"Hai ch·ªã em sinh ƒë√¥i."},
      {r:"Mark", e:"Where do they meet?", v:"H·ªç g·∫∑p nhau ·ªü ƒë√¢u?"},
      {r:"Hoa", e:"They meet at a summer camp.", v:"·ªû tr·∫°i h√®."},
      {r:"Mark", e:"What do people say about it?", v:"M·ªçi ng∆∞·ªùi n√≥i g√¨?"},
      {r:"Hoa", e:"People say young people should see it.", v:"Gi·ªõi tr·∫ª n√™n xem."}
    ]
  },
  {
    id: "skills2_ex3", title: "Skills 2 - Ex 3", desc: "Listening Quiz", type: "quiz",
    qs: [
      {q:"Naughty Twins is a ______.", v:"L√† phim...", o:[{t:"Comedy",v:"H√†i"},{t:"Sci-fi",v:""},{t:"Horror",v:""}], a:0, e:"Hoa: 'It's a comedy'."},
      {q:"The main characters are ______.", v:"Nh√¢n v·∫≠t ch√≠nh...", o:[{t:"Old classmates",v:""},{t:"Twin brothers",v:""},{t:"Twin sisters",v:"Ch·ªã em sinh ƒë√¥i"}], a:2, e:"Hoa: 'They are twin sisters'."},
      {q:"Where do they meet?", v:"G·∫∑p nhau ·ªü...", o:[{t:"At a summer camp",v:"Tr·∫°i h√®"},{t:"At a school",v:""},{t:"At a hospital",v:""}], a:0, e:"Hoa: 'At a summer camp'."},
      {q:"What do people say about the film?", v:"Nh·∫≠n x√©t...", o:[{t:"Shocking",v:""},{t:"Young people should see",v:"Gi·ªõi tr·∫ª n√™n xem"},{t:"Boring",v:""}], a:1, e:"Hoa: 'young people should see it'."}
    ]
  },

  // --- LOOKING BACK ---
  {
    id: "lb_ex1", title: "7. Looking Back - Ex 1", desc: "Match types of film", type: "quiz",
    qs: [
      {q:"A film about life in the future, robots...", v:"Phim v·ªÅ t∆∞∆°ng lai, robot...", o:[{t:"Sci-fi",v:""},{t:"Comedy",v:""},{t:"Horror",v:""}], a:0, e:"Sci-fi = Science Fiction."},
      {q:"This type of film makes you laugh.", v:"Phim l√†m b·∫°n c∆∞·ªùi.", o:[{t:"Comedy",v:""},{t:"Documentary",v:""},{t:"Fantasy",v:""}], a:0, e:"Comedy."},
      {q:"A frightening type of film.", v:"Phim ƒë√°ng s·ª£.", o:[{t:"Horror",v:""},{t:"Comedy",v:""},{t:"Sci-fi",v:""}], a:0, e:"Horror."},
      {q:"Gives useful information about animals, science...", v:"Th√¥ng tin h·ªØu √≠ch...", o:[{t:"Documentary",v:""},{t:"Action",v:""},{t:"Fantasy",v:""}], a:0, e:"Documentary."},
      {q:"Has supernatural events.", v:"S·ª± ki·ªán si√™u nhi√™n.", o:[{t:"Fantasy",v:""},{t:"History",v:""},{t:"Comedy",v:""}], a:0, e:"Fantasy."}
    ]
  },
  {
    id: "lb_ex3", title: "Looking Back - Ex 3", desc: "Vocab & Grammar Check", type: "quiz",
    qs: [
      {q:"The film was long and ______. People went home early.", v:"Phim d√†i v√†... n√™n v·ªÅ s·ªõm.", o:[{t:"funny",v:""},{t:"shocking",v:""},{t:"dull",v:"t·∫ª nh·∫°t"}], a:2, e:"V·ªÅ s·ªõm -> Phim ch√°n (dull)."},
      {q:"The film is too ______ with fighting and killing.", v:"Qu√°... v·ªõi c·∫£nh ƒë√°nh nhau.", o:[{t:"violent",v:"b·∫°o l·ª±c"},{t:"funny",v:""},{t:"interesting",v:""}], a:0, e:"ƒê√°nh nhau -> Violent."},
      {q:"A ______ story makes us feel afraid.", v:"C√¢u chuy·ªán... l√†m ta s·ª£.", o:[{t:"moving",v:""},{t:"frightening",v:"ƒë√°ng s·ª£"},{t:"funny",v:""}], a:1, e:"S·ª£ -> Frightening."},
      {q:"The news was ______. I couldn't believe it.", v:"Tin t·ª©c... kh√¥ng th·ªÉ tin n·ªïi.", o:[{t:"shocking",v:"g√¢y s·ªëc"},{t:"confusing",v:""},{t:"dull",v:""}], a:0, e:"Kh√¥ng tin n·ªïi -> Shocking."},
      {q:"______ films often make us cry.", v:"Phim... l√†m ta kh√≥c.", o:[{t:"Moving",v:"C·∫£m ƒë·ªông"},{t:"Funny",v:""},{t:"Boring",v:""}], a:0, e:"Kh√≥c -> Moving."},
      {q:"The road signs were ______, so we got lost.", v:"Bi·ªÉn b√°o... n√™n b·ªã l·∫°c.", o:[{t:"confusing",v:"g√¢y b·ªëi r·ªëi"},{t:"shocking",v:""},{t:"interesting",v:""}], a:0, e:"B·ªã l·∫°c -> Confusing."}
    ]
  },
  {
    id: "lb_ex4", title: "Looking Back - Ex 4", desc: "Match Sentences", type: "quiz",
    qs: [
      {q:"Although he arrived late, ______.", v:"M·∫∑c d√π ƒë·∫øn mu·ªôn...", o:[{t:"he left the cinema early",v:"v·ªÅ s·ªõm"},{t:"he stayed late",v:""},{t:"he was happy",v:""}], a:0, e:"T∆∞∆°ng ph·∫£n: ƒê·∫øn mu·ªôn nh∆∞ng l·∫°i v·ªÅ s·ªõm."},
      {q:"The film received good reviews. ______.", v:"Phim nh·∫≠n ƒë√°nh gi√° t·ªët...", o:[{t:"However, few people saw it",v:"Nh∆∞ng √≠t ng∆∞·ªùi xem"},{t:"So everyone saw it",v:""},{t:"It was bad",v:""}], a:0, e:"T·ªët nh∆∞ng √≠t ng∆∞·ªùi xem -> However."},
      {q:"Though tickets are expensive, ______.", v:"M·∫∑c d√π v√© ƒë·∫Øt...", o:[{t:"people still buy them",v:"ng∆∞·ªùi ta v·∫´n mua"},{t:"no one buys",v:""},{t:"it is cheap",v:""}], a:0, e:"ƒê·∫Øt nh∆∞ng v·∫´n mua -> Though."},
      {q:"Although I don't like the cinema, ______.", v:"M·∫∑c d√π kh√¥ng th√≠ch r·∫°p...", o:[{t:"I don't want to stay home",v:"T√¥i kh√¥ng mu·ªën ·ªü nh√†"},{t:"I will stay home",v:""},{t:"I hate films",v:""}], a:0, e:"T∆∞∆°ng ph·∫£n."}
    ]
  }
];

/* ==========================================================================
   ENGINE
   ========================================================================== */
let totalQ = 0;
let answeredQ = 0;
let score = 0;
let isMusicOn = false;
let isViVisible = true;
let audioCtx, musicInterval;
let synth = window.speechSynthesis;
let voices = [];

// Pre-calc total questions
DATA.forEach(s => { if(s.qs) totalQ += s.qs.length; });

window.onload = () => {
  if (synth.onvoiceschanged !== undefined) synth.onvoiceschanged = () => { voices = synth.getVoices(); };
  setTimeout(() => { voices = synth.getVoices(); }, 500);
  
  document.getElementById('totalQ').innerText = totalQ;
  renderSidebar();
  loadSlide(0);
};

// --- RENDER SIDEBAR ---
function renderSidebar() {
  const sb = document.getElementById('sidebar');
  let html = '';
  DATA.forEach((sec, i) => {
    html += `<button class="nav-btn ${i===0?'active':''}" id="nav-${i}" onclick="loadSlide(${i})">
      ${sec.title} <br><span style="font-size:11px; opacity:0.7">${sec.desc}</span>
    </button>`;
  });
  sb.innerHTML = html;
}

// --- RENDER SLIDE ---
function loadSlide(idx) {
  // Reset previous audio/animations if any
  stopAudio();
  
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById(`nav-${idx}`).classList.add('active');

  const data = DATA[idx];
  const main = document.getElementById('main');
  
  let html = `<div class="slide">
    <h2>${data.title}</h2>
    <div class="desc">${data.desc}</div>`;

  // TYPE: DIALOGUE
  if (data.type === 'dialogue') {
    html += `
      <div style="margin-bottom:10px;">
        <button class="ctrl-btn active" onclick="playScript(${idx})">‚ñ∂ Nghe h·ªôi tho·∫°i</button>
        <button class="ctrl-btn" onclick="stopAudio()">‚óº D·ª´ng</button>
      </div>
      <div class="scroll-content">`;
    data.script.forEach((l, i) => {
      html += `<div class="line" id="line-${i}" onclick="speakLine(${idx}, ${i})">
        <span class="role" style="color:${getRoleColor(l.r)}">${l.r}:</span> 
        <span class="en">${l.e}</span>
        <span class="vi ${isViVisible?'':'hidden'}">${l.v}</span>
      </div>`;
    });
    html += `</div>
      <button class="next-btn" onclick="loadSlide(${idx+1})" style="display:block">Ti·∫øp theo ‚ûú</button>
    `;
  }
  
  // TYPE: READING
  else if (data.type === 'reading') {
    html += `<div class="scroll-content">`;
    data.content.forEach(p => {
      html += `<p style="margin-bottom:12px">
        <span class="en" style="font-weight:600">${p.e}</span>
        <span class="vi ${isViVisible?'':'hidden'}">${p.v}</span>
      </p>`;
    });
    html += `</div>
      <button class="next-btn" onclick="loadSlide(${idx+1})" style="display:block">B·∫Øt ƒë·∫ßu tr·∫£ l·ªùi c√¢u h·ªèi ‚ûú</button>
    `;
  }

  // TYPE: QUIZ (MCQ & WORD BANK)
  else if (data.type === 'quiz') {
    data.qs.forEach((q, qIdx) => {
      html += `
        <div class="q-block" id="q-${idx}-${qIdx}">
          <div class="q-text">${qIdx+1}. ${q.q}</div>
          <div class="q-vi ${isViVisible?'':'hidden'}">${q.v}</div>
          <div class="opts-grid">`;
      q.o.forEach((opt, oIdx) => {
        html += `<button class="opt-btn" onclick="checkAns(this, ${idx}, ${qIdx}, ${oIdx}, ${q.a})">
          <span>${opt.t}</span>
          <span class="opt-sub ${isViVisible?'':'hidden'}">${opt.v}</span>
        </button>`;
      });
      html += `</div>
          <div class="expl-box" id="expl-${idx}-${qIdx}">
            <span style="font-weight:bold; color:#00E5FF">GI·∫¢I TH√çCH:</span> ${q.e}
          </div>
        </div>
      `;
    });
    if (idx < DATA.length - 1) {
      html += `<button class="next-btn" style="display:block" onclick="loadSlide(${idx+1})">Chuy·ªÉn ph·∫ßn ti·∫øp theo ‚ûú</button>`;
    } else {
      html += `<div style="text-align:center; margin-top:20px; color:#00E5FF; font-weight:bold">üéâ CH√öC M·ª™NG! B·∫†N ƒê√É HO√ÄN TH√ÄNH TO√ÄN B·ªò B√ÄI H·ªåC! üéâ</div>`;
    }
  }

  html += `</div>`;
  main.innerHTML = html;
}

// --- LOGIC ---
function checkAns(btn, sIdx, qIdx, uAns, cAns) {
  // Disable options for this question
  const parent = btn.parentElement;
  const btns = parent.getElementsByClassName('opt-btn');
  for(let b of btns) b.style.pointerEvents = 'none';

  // Show explanation
  document.getElementById(`expl-${sIdx}-${qIdx}`).style.display = 'block';

  if (uAns === cAns) {
    btn.classList.add('correct');
    score += 10;
    document.getElementById('score').innerText = score;
  } else {
    btn.classList.add('wrong');
    btns[cAns].classList.add('correct'); // Show correct answer
  }
  
  answeredQ++;
  document.getElementById('qCount').innerText = Math.min(answeredQ, totalQ);
}

function getRoleColor(role) {
  if(['Mark','Nick','Tom'].includes(role)) return '#00E5FF'; // Blue
  if(['Mi','Lan','Hoa'].includes(role)) return '#FF0055'; // Red
  return '#FFD700'; // Yellow
}

// --- AUDIO & TTS ---
function toggleMusic() {
  isMusicOn = !isMusicOn;
  const btn = document.getElementById('btnMusic');
  btn.innerText = isMusicOn ? "üéµ Nh·∫°c: ON" : "üéµ Nh·∫°c: OFF";
  btn.classList.toggle('music-on', isMusicOn);

  if (isMusicOn) {
    if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    if (audioCtx.state === 'suspended') audioCtx.resume();
    playBeat();
  } else {
    clearInterval(musicInterval);
  }
}

function playBeat() {
  // 130 BPM energetic loop
  const notes = [523.25, 659.25, 783.99, 1046.50, 783.99, 659.25];
  let step = 0;
  
  function tick() {
    if (!isMusicOn) return;
    const now = audioCtx.currentTime;
    
    if (step % 2 === 0) {
      let osc = audioCtx.createOscillator();
      let g = audioCtx.createGain();
      osc.type = 'triangle';
      osc.frequency.value = notes[Math.floor(Math.random()*notes.length)];
      g.gain.setValueAtTime(0, now);
      g.gain.linearRampToValueAtTime(0.05, now + 0.05);
      g.gain.exponentialRampToValueAtTime(0.001, now + 0.3);
      osc.connect(g); g.connect(audioCtx.destination);
      osc.start(now); osc.stop(now + 0.4);
    }
    step++;
  }
  musicInterval = setInterval(tick, 150);
}

function playScript(idx) {
  if(isMusicOn) clearInterval(musicInterval);
  const script = DATA[idx].script;
  synth.cancel();
  let i = 0;
  
  function next() {
    if (i >= script.length) {
      if(isMusicOn) playBeat();
      return;
    }
    const line = script[i];
    const u = new SpeechSynthesisUtterance(line.e);
    
    // Voice selection
    const voices = synth.getVoices();
    const isFemale = ['Mi','Lan','Hoa'].includes(line.r);
    u.voice = voices.find(v => v.name.includes(isFemale ? 'Female' : 'Male')) || voices[0];
    u.rate = 0.9;

    document.querySelectorAll('.line').forEach(l => l.classList.remove('active'));
    const el = document.getElementById(`line-${i}`);
    if(el) {
      el.classList.add('active');
      el.scrollIntoView({behavior:"smooth", block:"center"});
    }

    u.onend = () => { i++; next(); };
    synth.speak(u);
  }
  next();
}

function stopAudio() {
  synth.cancel();
  if(isMusicOn) playBeat();
}

function speakLine(sIdx, lIdx) {
  synth.cancel();
  const line = DATA[sIdx].script[lIdx];
  const u = new SpeechSynthesisUtterance(line.e);
  const voices = synth.getVoices();
  const isFemale = ['Mi','Lan','Hoa'].includes(line.r);
  u.voice = voices.find(v => v.name.includes(isFemale ? 'Female' : 'Male')) || voices[0];
  synth.speak(u);
  
  document.querySelectorAll('.line').forEach(l => l.classList.remove('active'));
  document.getElementById(`line-${lIdx}`).classList.add('active');
}

function toggleVi() {
  isViVisible = !isViVisible;
  document.querySelectorAll('.vi, .q-vi, .opt-sub').forEach(el => el.classList.toggle('hidden', !isViVisible));
  const btn = document.getElementById('btnVi');
  btn.classList.toggle('active');
  btn.innerText = isViVisible ? "üáªüá≥ D·ªãch: ON" : "üáªüá≥ D·ªãch: OFF";
}

</script>
</body>
</html>